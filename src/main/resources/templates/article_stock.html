<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>記事ストック</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
<div>
  <header th:replace="~{fragments/common-header :: common-header}"></header>
</div>

<div class="sidebar" th:replace="~{fragments/common-sidebar :: common-sidebar}"></div>

  <div class="article-stock-container">
    <!-- まだ登録されていない場合 -->
    <th:block th:unless="${actionDtoList != null}">
      <div class="empty-stock">
        <p>まだ記事ストックが登録されていません。</p>
        <div class="register-stock">
          <a th:href="@{/article_stock/edit/0}">最初の記事ストックを登録する</a>
        </div>
      </div>
    </th:block>

    <!-- 登録されている場合 -->
    <th:block th:if="${actionDtoList != null}">
      <div class="register-stock">
        <a th:href="@{/article_stock/edit/0}">記事ストックを追加する</a>
      </div>

      <div class="article-stock-content">
        <div th:each="articleStock : ${actionDtoList}">
          <table class="article-stock-table">
            <tr>
              <td colspan="2" class="stock-header-area">
                <div class="stock-header">
                  <div class="at-info">
                    <p th:text="'登録日時: ' + ${articleStock.registeredAt}"></p>
                    <p th:if="${articleStock.updatedAt} != null" th:text="'更新日時: ' + ${articleStock.updatedAt}"></p>
                  </div>

                  <div class="edit-delete-stock">
                    <a th:href="@{/article_stock/edit/{id}(id=${articleStock.id})}">
                      <img th:src="@{/image/edit-icon.svg}" alt="編集">
                    </a>
                    <a href="#"
                       onclick="if(confirm('この目標を削除しますか？')) {
                                    document.getElementById('deleteStock').submit();
                                } return false;">
                      <img th:src="@{/image/delete-icon.svg}" alt="削除">
                    </a>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <th scope="row">タイトル</th>
              <td th:text="${articleStock.title}"></td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td class="input-url">
                <a href="${articleStock.url}">
                  <div th:text="${articleStock.url}"></div>
                </a>
              </td>
            </tr>
            <tr>
              <th scope="row">閲覧状況</th>
              <td th:text="${articleStock.statusLabel}"></td>
            </tr>
            <tr>
              <th:block th:with="rawTag=${articleStock.tags}">
                <th scope="row">タグ</th>
                <td class="tags" th:text="${#strings.replace(rawTag, ',', ' ')}"></td>
              </th:block>
            </tr>
          </table>

          <form id="deleteStock" th:action="@{/article_stock/{id}(id=${articleStock.id})}" method="post" style="display:none;">
            <input type="hidden" name="_method" value="delete">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}">
          </form>
        </div>
      </div>
    </th:block>
  </div>
</body>
</html>