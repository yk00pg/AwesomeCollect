<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css" rel="stylesheet" type="text/css" />

<head>
  <meta charset="UTF-8">
  <title>記事ストック編集</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
  <div>
    <header th:replace="~{fragments/common-header :: common-header}"></header>
  </div>

  <div class="sidebar" th:replace="~{fragments/common-sidebar :: common-sidebar}"></div>

  <div class="article-stock-container">
    <div class="back-indicator">
      <a th:href="@{/article_stock}">
        <img th:src="@{/image/back-icon.svg}" alt="戻る">
        <span>戻る</span>
      </a>
    </div>

    <form class="article-stock-form"
          th:action="@{/article_stock/edit/{id}(id=${actionDto.id})}"
          th:object="${actionDto}" method="post">
      <div class="article-stock-form-title">記事ストック</div>
      <div class="input-content">
        <table class="stock-edit-table">
          <tr>
            <th scope="row" class="row-th">タイトル</th>
            <td class="blank-cell"></td>
            <td>
              <input type="text" th:field="*{title}" required/>
            </td>
          </tr>
          <tr class="blank-row"></tr>
          <tr>
            <th scope="row" class="row-th">URL</th>
            <td class="blank-cell"></td>
            <td>
              <input type="text" id="url" th:field="*{url}" required/>
            </td>
          </tr>
          <tr class="blank-row"></tr>
          <tr>
            <th scope="row" class="row-th">閲覧状況</th>
            <td class="blank-cell"></td>
            <td>
              <select class="select-stock-status" th:field="*{status}">
                <option value="">選択してください</option>
                <option value="stillNot">これから読む</option>
                <option value="finished">読んだ</option>
              </select>
            </td>
          </tr>
          <tr class="blank-row"></tr>
          <tr>
            <th scope="row" class="row-th">タグ</th>
            <td class="blank-cell"></td>
            <td>
              <input type="text" id="tags-input" th:field="*{tags}" class="tags-input">
            </td>
          </tr>
        </table>

        <script th:inline="javascript">
          /*<![CDATA[*/
            const tagNameList = /*[[${tagNameList}]]*/ [];
            const input = document.querySelector("#tags-input");

            new Tagify(input, {
                pattern: /#/,
                whitelist: tagNameList,
                dropdown: {
                  enabled: 0,
                  classname: "tags-look",
                  maxItems: 10,
                  closeOnSelect: false
                  },
                  enforceWhitelist: false,
            });
          /*]]>*/
        </script>
      </div>
      <div class="button-area">
        <button type="submit" class="register-button">登録</button>
      </div>
    </form>
  </div>
</body>