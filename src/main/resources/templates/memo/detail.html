<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>メモ詳細</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
  <div>
    <header th:replace="~{fragments/common-header :: common-header}"></header>
  </div>

  <div class="sidebar" th:replace="~{fragments/common-sidebar :: common-sidebar}"></div>

  <div class="memo-detail-container">
    <div class="back-indicator">
      <a th:href="@{/memo}">
        <img th:src="@{/image/back-icon.svg}" alt="戻る">
        <span>戻る</span>
      </a>
    </div>

    <div class="memo-header">
      <div class="at-info">
        <p th:text="'登録日時: ' + ${actionDto.registeredAt}"></p>
        <p th:if="${actionDto.updatedAt} != null" th:text="'更新日時: ' + ${actionDto.updatedAt}"></p>
      </div>

      <div class="edit-delete">
        <a th:href="@{/memo/detail/edit/{id}(id=*{id})}">
          <img th:src="@{/image/edit-icon.svg}" alt="編集">
        </a>
        <a href="#"
           onclick="if(confirm('この目標を削除しますか？')) {
                              document.getElementById('deleteMemo').submit();
                          } return false;">
          <img th:src="@{/image/delete-icon.svg}" alt="削除">
        </a>
      </div>
    </div>

    <div class="memo-content">
      <table class="memo-detail-table">
        <tr>
          <th scope="col">メモタイトル</th>
          <td th:text="${actionDto.title}"></td>
        </tr>
        <tr>
          <th colspan="2" scope="col">内
            容</th>
        </tr>
        <tr>
          <td colspan="2" th:utext="${actionDto.contentAsHtml}"></td>
        </tr>
        <tr>
          <th:block th:with="rawTag=${actionDto.tags}">
            <th scope="row">タグ</th>
            <td class="tags" th:text="${#strings.replace(rawTag, ',', ' ')}"></td>
          </th:block>
        </tr>
      </table>
      <div class="note">
        <small>※ 画像を含む場合、セキュリティの観点から直接表示せず、リンクで代替しています</small>
      </div>
    </div>

    <form id="deleteMemo" th:action="@{/memo/detail/{id}(id=${actionDto.id})}" method="post" style="display:none;">
      <input type="hidden" name="_method" value="delete">
      <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}">
    </form>
  </div>
</body>